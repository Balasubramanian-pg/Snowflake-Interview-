# 11.9. Rights Model

Canonical documentation for [11.9. Rights Model](2. Data Engineering & Pipelines/11. Snowpark & Developer/11.9. Rights Model.md). This document defines concepts, terminology, and standard usage.

## Purpose
The Rights Model exists to provide a structured framework for governing the interactions between entities and resources within a system. It addresses the fundamental requirement of information security: ensuring that only authorized entities can perform specific actions on designated resources. By defining a formal model, organizations can enforce security policies, maintain data integrity, and ensure accountability through a consistent and predictable logic of access control.

> [!NOTE]
> This documentation is intended to be implementation-agnostic and authoritative, focusing on the logical architecture of rights rather than specific software configurations.

## Scope
This document covers the theoretical and structural components of rights management, including the relationship between subjects, objects, and permissions.

> [!IMPORTANT]
> **In scope:**
> * Core functionality of access control logic.
> * Theoretical boundaries of permission assignment and inheritance.
> * Structural taxonomies for rights categorization.

> [!WARNING]
> **Out of scope:**
> * Specific vendor implementations (e.g., AWS IAM, Azure RBAC, Kubernetes RBAC).
> * Physical security access controls.
> * Network-layer protocol specifications.

## Definitions
Provide precise definitions for key terms.

| Term | Definition |
|------|------------|
| Principal | A unique entity (user, service, or process) capable of requesting an action. |
| Resource | An object or service upon which an action is performed. |
| Permission | The formal declaration of an allowed operation (e.g., Read, Write, Execute). |
| Right | The specific binding of a Principal to a Permission on a Resource. |
| Scope | The boundary or context within which a Right is valid. |
| Privilege | A specialized right that grants administrative or elevated capabilities. |
| Entitlement | The set of rights currently assigned to a specific Principal. |

## Core Concepts
The Rights Model is built upon the interaction of three primary pillars: the **Subject** (who), the **Action** (what), and the **Object** (on what).

**The Principle of Least Privilege (PoLP)**
The foundational rule of any Rights Model is that a Principal must be granted only the minimum rights necessary to perform their designated function. This limits the "blast radius" in the event of a credential compromise.

**Separation of Duties (SoD)**
This concept ensures that no single Principal has enough rights to complete a sensitive process end-to-end without oversight. For example, the Principal who creates a financial record should not be the same Principal who approves it.

> [!TIP]
> Think of a Rights Model as a library card system: the cardholder (Principal) has the permission to borrow (Action) a specific book (Resource), but only if the book is within the lending section (Scope) and the card hasn't expired (Constraint).

## Standard Model
The standard model for rights management follows a hierarchical flow of evaluation:

1.  **Identification:** The system recognizes the Principal.
2.  **Authentication:** The system verifies the Principal's identity.
3.  **Authorization:** The system checks the Rights Model to determine if the Principal is permitted to perform the requested Action on the target Resource.
4.  **Evaluation:** The model resolves conflicting rights (e.g., an explicit "Deny" usually overrides an "Allow").

The relationship is typically expressed as:
`Right = (Principal + Action + Resource) * Constraints`

## Common Patterns
Several recurring patterns are used to organize rights effectively:

*   **Role-Based Access Control (RBAC):** Rights are assigned to roles, and Principals are assigned to those roles. This simplifies management by decoupling individuals from specific permissions.
*   **Attribute-Based Access Control (ABAC):** Rights are granted based on attributes (e.g., "If Principal.Department == 'Finance' and Resource.Type == 'Invoice'"). This allows for highly dynamic and granular control.
*   **Access Control Lists (ACLs):** A list attached to a Resource specifying which Principals have which permissions.
*   **Discretionary Access Control (DAC):** The owner of a Resource has the authority to grant rights to others at their discretion.

## Anti-Patterns
Common mistakes or discouraged practices in rights modeling include:

*   **Hardcoding Rights:** Embedding specific user IDs or permissions directly into application logic rather than using a centralized model.
*   **God-Mode Accounts:** Creating administrative accounts with unrestricted rights across all scopes, creating a single point of catastrophic failure.
*   **Permission Creep:** Failing to revoke rights when a Principal's role changes, leading to an accumulation of unnecessary privileges.
*   **Excessive Nesting:** Creating deep hierarchies of roles or groups that make it impossible to audit the effective rights of a Principal.

> [!CAUTION]
> Avoid circular dependencies where Role A inherits from Role B, and Role B inherits from Role A. This can lead to stack overflows in evaluation engines or unpredictable security holes.

## Edge Cases
*   **Orphaned Objects:** Resources whose owners have been deleted from the system, potentially leaving the resource inaccessible or open to unauthorized takeover.
*   **Break-Glass Scenarios:** Emergency situations where standard rights must be bypassed to restore system functionality. These require highly audited, temporary "emergency" rights.
*   **Conflicting Inheritance:** When a Principal belongs to two groupsâ€”one that allows an action and one that denies it. The model must have a deterministic resolution strategy (usually "Deny-by-default").
*   **Transitive Delegation:** When Principal A grants rights to Principal B, who then attempts to grant those same rights to Principal C. The model must define if rights are "transferable."

## Related Topics
*   **Identity and Access Management (IAM):** The broader discipline encompassing the Rights Model.
*   **Audit Logging:** The record-keeping mechanism that tracks the exercise of rights.
*   **Policy as Code (PaC):** The practice of defining the Rights Model through version-controlled configuration files.

## Change Log
| Version | Date | Description |
|---------|------|-------------|
| 1.0 | 2026-02-17 | Initial AI-generated canonical documentation |