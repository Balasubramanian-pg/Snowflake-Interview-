# 12.4. Access History

Canonical documentation for [12.4. Access History](2. Data Engineering & Pipelines/12. Governance/12.4. Access History.md). This document defines concepts, terminology, and standard usage.

## Purpose
Access History serves as the definitive chronological record of interactions between subjects (users, services, or automated processes) and resources within a system. Its primary purpose is to provide transparency, accountability, and a verifiable audit trail. By maintaining a granular history of access, organizations can satisfy regulatory compliance requirements, perform forensic analysis during security incidents, and optimize system performance by understanding usage patterns.

> [!NOTE]
> This documentation is intended to be implementation-agnostic and authoritative, focusing on the structural and conceptual requirements of access logging rather than specific software solutions.

## Scope
This documentation covers the theoretical framework, data requirements, and lifecycle management of access records.

> [!IMPORTANT]
> **In scope:**
> * Data structures for access events (Who, What, When, Where, How).
> * Principles of immutability and integrity in record-keeping.
> * Retention and archival strategies.
> * Privacy considerations regarding access metadata.

> [!WARNING]
> **Out of scope:**
> * Specific vendor implementations (e.g., AWS CloudTrail, Azure Monitor).
> * Network-level packet inspection (PCAP) unless summarized as an access event.
> * Real-time intrusion detection system (IDS) logic.

## Definitions
| Term | Definition |
|------|------------|
| Principal | The entity (user, service account, or device) requesting access. |
| Resource | The target object or service being accessed (e.g., a file, API endpoint, or database record). |
| Access Event | A single discrete interaction between a principal and a resource. |
| Metadata | Contextual information surrounding an event, such as IP address, user agent, or geographic location. |
| Immutability | The property of a record that prevents it from being modified or deleted once written. |
| Retention Policy | The defined duration for which access history must be stored before archival or destruction. |

## Core Concepts
The fundamental premise of Access History is the creation of a non-repudiable link between an identity and an action.

### The Five Pillars of an Access Record
To be considered complete, an access history entry must address five dimensions:
1.  **Identity (Who):** The unique identifier of the principal.
2.  **Action (What):** The specific operation performed (e.g., Read, Write, Delete, Execute).
3.  **Timestamp (When):** An accurate, synchronized record of the event time.
4.  **Target (Where):** The specific resource or system component affected.
5.  **Outcome (Result):** Whether the attempt was successful or denied (and why).

> [!TIP]
> Think of Access History as a "black box flight recorder" for digital assets. It doesn't influence the flight itself, but it provides the only objective truth of what occurred during the journey.

## Standard Model
The standard model for Access History follows an **Append-Only Immutable Ledger** approach. In this model, events are streamed or written to a persistent store where they cannot be altered by the principals who generated them.

### Data Schema Requirements
A standardized access log entry should include:
*   **Event ID:** A globally unique identifier (UUID) for the record.
*   **Principal Context:** User ID, Session ID, and associated Roles/Permissions at the time of access.
*   **Temporal Data:** ISO 8601 formatted timestamps, preferably in UTC to avoid timezone ambiguity.
*   **Source Context:** Originating IP address, device identifiers, and protocol information.
*   **Resource Context:** Resource URI, Type, and Version.

## Common Patterns
*   **Centralized Aggregation:** Collecting access history from disparate microservices into a single, hardened repository for cross-correlation.
*   **Tiered Retention:** Keeping high-resolution history in "hot" storage for immediate troubleshooting (e.g., 30 days) and moving it to "cold" compressed storage for long-term compliance (e.g., 7 years).
*   **Just-in-Time (JIT) Enrichment:** Adding metadata to an access record at the moment of capture to ensure the context (like a user's department) is preserved even if the user's profile changes later.

## Anti-Patterns
*   **Log-and-Forget:** Collecting massive amounts of access data without a mechanism for analysis or alerting.
*   **Mutable History:** Allowing administrators or system processes to edit or delete specific entries in the access history, which destroys the chain of custody.
*   **Excessive Verbosity:** Recording every minor system heartbeat, which creates "noise" and obscures critical security events.
*   **Storing Sensitive Data:** Including PII (Personally Identifiable Information) or secrets (passwords, API keys) within the access history metadata.

> [!CAUTION]
> Avoid circular dependencies where the system responsible for securing the access history uses the same access history mechanism for its own logs, potentially leading to a "deadlock" during system failures.

## Edge Cases
*   **Clock Drift:** When the source system's clock is out of sync with the central repository, leading to out-of-order events.
*   **Impersonation/Delegation:** Recording history when a service acts on behalf of a user (the "On-Behalf-Of" pattern). Both the service and the end-user must be captured.
*   **System-Level Actions:** Distinguishing between a human-initiated action and an automated system maintenance task (e.g., automated backups).
*   **Disconnected Operations:** Handling access history generated on edge devices that are offline and must sync their history later.

## Related Topics
*   **12.1. Identity and Access Management (IAM):** The source of the "Principal" definitions.
*   **12.5. Audit Logging:** The broader practice of recording system-wide changes beyond just resource access.
*   **Data Sovereignty:** Legal requirements regarding where access history data can be physically stored.

## Change Log
| Version | Date | Description |
|---------|------|-------------|
| 1.0 | 2026-02-17 | Initial AI-generated canonical documentation |